WITH 
    TERMS_DESC AS (
        SELECT
            SUBSTR(CAST(ID AS varchar(10)),1,2) AS ID,
            ABBREVIATION
        FROM
            TERMS
        WHERE
            ISYEARREC = 1 AND SCHOOLID = 300
    )

SELECT 
    STU.STUDENT_NUMBER as STUDENT_NUMBER,
    STU.LASTFIRST as STUDENT_NAME,
    DECODE (STU.ENROLL_STATUS,
    0, 'Current',
    'Former') as STUDENT_STATUS,
    STU.GRADE_LEVEL as CURRENT_GRADE_LEVEL,
    TERMS_DESC.ABBREVIATION AS YEAR,
    T.ABBREVIATION AS TERM,
    SG.TERMID,
    DECODE(SG.STORECODE,
    'M1','Q1',
    'M2','Q3',
    'Y1','S2',
    SG.STORECODE) AS STORECODE,
    SG.GRADE,
    SG.EARNEDCRHRS AS CREDITS,
    SG.COMMENT_VALUE,
    SG.COURSE_NAME,
    SG.COURSE_NUMBER,
    SG.GRADE_LEVEL,
    SG.SCHOOLID,
    SG.SCHOOLNAME,
    SG.TEACHER_NAME
FROM STUDENTS STU INNER JOIN STOREDGRADES SG ON STU.DCID = SG.STUDENTID
    RIGHT JOIN TERMS T ON T.ID = SG.TERMID
    INNER JOIN (SELECT * FROM TERMS_DESC) TERMS_DESC ON TERMS_DESC.ID = SUBSTR(CAST(SG.TERMID AS varchar(10)),1,2)
WHERE STU.STUDENT_NUMBER = 300062 AND SG.SCHOOLID = 300